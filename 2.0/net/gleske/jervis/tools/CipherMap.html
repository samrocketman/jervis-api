<!--

     Licensed to the Apache Software Foundation (ASF) under one
     or more contributor license agreements.  See the NOTICE file
     distributed with this work for additional information
     regarding copyright ownership.  The ASF licenses this file
     to you under the Apache License, Version 2.0 (the
     "License"); you may not use this file except in compliance
     with the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

     Unless required by applicable law or agreed to in writing,
     software distributed under the License is distributed on an
     "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
     specific language governing permissions and limitations
     under the License.

-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- **************************************************************** -->
<!-- *  PLEASE KEEP COMPLICATED EXPRESSIONS OUT OF THESE TEMPLATES, * -->
<!-- *  i.e. only iterate & print data where possible. Thanks, Jez. * -->
<!-- **************************************************************** -->

<html>
<head>
    <!-- Generated by groovydoc -->
    <title>CipherMap (Jervis 2.0 API)</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link href="../../../../groovy.ico" type="image/x-icon" rel="shortcut icon">
    <link href="../../../../groovy.ico" type="image/x-icon" rel="icon">
    <link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
    <link rel="stylesheet" href="../../../../styles/base16/harmonic16-dark.min.css">
    <script src="../../../../highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

<body class="center">
<script type="text/javascript"><!--
if (location.href.indexOf('is-external=true') == -1) {
    parent.document.title="CipherMap (Jervis 2.0 API)";
}
//-->
</script>
<noscript>
    <div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
    <!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
    <!--   -->
</a>
    <ul class="navList" title="Navigation">
        <li><a href="../../../../overview-summary.html">Overview</a></li>
        <li><a href="package-summary.html">Package</a></li>
        <li class="navBarCell1Rev">Class</li>
        <li><a href="../../../../deprecated-list.html">Deprecated</a></li>
        <li><a href="../../../../index-all.html">Index</a></li>
        <li><a href="../../../../help-doc.html">Help</a></li>
    </ul>
</div>

<div class="subNav">
    <div>
        <ul class="navList">
            <li><a href="../../../../index.html?net/gleske/jervis/tools/CipherMap" target="_top">Frames</a></li>
            <li><a href="CipherMap.html" target="_top">No Frames</a></li>
        </ul>
    </div>
    <div>
        <ul class="subNavList">
            <li>Summary:&nbsp;</li>
            Nested&nbsp;&nbsp;&nbsp;Field&nbsp;&nbsp;&nbsp;<li><a href="#property_summary">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_summary">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_summary">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
        <ul class="subNavList">
            <li>&nbsp;|&nbsp;Detail:&nbsp;</li>
            Field&nbsp;&nbsp;&nbsp;<li><a href="#prop_detail">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_detail">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_detail">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
    </div>
    <a name="skip-navbar_top">
        <!--   -->
    </a></div>
<!-- ========= END OF TOP NAVBAR ========= -->

<!-- ======== START OF CLASS DATA ======== -->
<div class="header">

    <div class="subTitle">Package: <strong>net.gleske.jervis.tools</strong></div>

    <h2 title="[Groovy] Class CipherMap" class="title">[Groovy] Class CipherMap</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><ul class="inheritance"></ul></li><li>net.gleske.jervis.tools.CipherMap
</ul>
<div class="description">
    <ul class="blockList">
        <li class="blockList">

            <dl>
                <dt>All Implemented Interfaces and Traits:</dt>
                <dd><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/Serializable.html' title='Serializable'>Serializable</a></dd>
            </dl>
            <!-- todo: direct known subclasses -->
            <hr>
            <br>
<pre>class CipherMap
extends <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html' title='Object'>Object</a>

</pre>



    <p>
  Strong encrypted storage backend used for encrypting a <tt>Map</tt> at rest.
  The must consist only of standard java class types.  Serialization and
  deseralization provided by
  <tt><a href='../../../../net/gleske/jervis/tools/YamlOperator.html' title='YamlOperator'>YamlOperator</a></tt>.

  <h2>Encryption details</h2>

  <p>In general, this class uses algorithms processes recommended by
  <a href="https://csrc.nist.gov/publications/fips" target=_blank>NIST FIPS</a>
  in FIPS 180-4, FIPS 186-4, FIPS 197, and FIPS 198-1.  FIPS 202 was considered
  but not currently used.  The author of this class made a best-effort towards
  understanding these standards and implementing them in code.  However,
  there's no warranty on correctness or 3rd party certification.  As a
  reminder, please reference the license of this project before use.</p>

  <p>Some other high level details include.</p>

  <ul>
  <li>
    Upon instantiation the AES cipher secret and initialization vector (IV) are
    randomly generated bytes.  The random secret is 32 bytes and the random IV
    is 16 bytes.
  </li>
  <li>
    The cipher secret and IV are asymmetrically encrypted with RSA.  The
    stronger the RSA key provided the more secure the encryption at rest.
    Keys below 2048-bits will throw an exception for being too weak.
    Recommended RSA private key size is 4096-bit.
  </li>
  <li>
    The data is encrypted with AES-256 CBC with PKCS5 padding.  The cipher
    secret and IV are the inputs for encryption and decryption.
  </li>
  <li>
    The random IV is hashed with 5000 iterations of SHA-256 (let's call this
    initialization hash) and the resulting hash is passed into PBKDF2 with Hmac
    SHA-256 (PBKDF for short).  The PBKDF has variable iterations based on the
    provided initialization hash.  The iterations for PBKDF range from 100100
    to 960000 iterations.  Since this is configurable via
    <tt><a href='#hash_iterations'>hash_iterations</a></tt> it's possible to fully disable this
    behavior (setting <tt>hash_iterations</tt> to zero) and only use the
    provided secret and IV unmodified.
  </li>
  <li>
    After encryption, the encrypted value is signed with an RS256 signature
    (which is RSA-SHA-256 Base64Url encoded).  This signature is later used
    before decryption.  Decryption will only occur if the signature is valid.
    An empty map is the default if the signature is invalid.
  </li>
  <li>
    The cipher secret and IV infrequently change to protect against RSA attack
    utilizing Chinese Remainder Theorem.  The cipher secret and IV are
    automatically rotated if the secrets (secret/IV) are older than 30 days
    when data is encrypted.
  </li>
  </ul>

  <h2>Sample usage</h2>
  <p>To run this example, clone Jervis and execute <tt>./gradlew console</tt>
  to bring up a <a href="http://groovy-lang.org/groovyconsole.html" target="_blank">Groovy Console</a>
  with the classpath set up.</p>

<pre><code>
import net.gleske.jervis.tools.CipherMap
import java.time.Instant

Map plainTextMap = [hello: 'world']

Long time(Closure c) {
    Instant before = Instant.now()
    c()
    Instant after = Instant.now()
    after.epochSecond - before.epochSecond
}

def cmap1 = new CipherMap(new File('src/test/resources/rsa_keys/good_id_rsa_4096'))

Long timing = time {
    cmap1.plainMap = plainTextMap
}
println("Time encrypting: ${timing} second(s)")

def cmap2 = new CipherMap(new File('src/test/resources/rsa_keys/good_id_rsa_4096'))
timing = time {
    cmap2 << cmap1.toString()
    cmap2.plainMap
}

println("Time to load from String and decrypt: ${timing} second(s)")

// re-encrypt with stronger security
def cmap3 = new CipherMap(new File('src/test/resources/rsa_keys/good_id_rsa_4096').text)
cmap3.hash_iterations = 100100

timing = time {
    cmap3.plainMap = cmap1.plainMap
}
println("Time migrating to stronger encryption with 100100 hash iterations: ${timing} second(s)")
println(['\n', '='*80, 'Encrypted contents with CipherMap toString()'.with { ' '*(40 - it.size()/2) + it }, '='*80, "\n${cmap3}"].join('\n'))
</code></pre>
  </p>

          </li>
    </ul>
</div>

<div class="summary">
    <ul class="blockList">
        <li class="blockList">
        <!-- =========== NESTED CLASS SUMMARY =========== -->
        

        <!-- =========== ENUM CONSTANT SUMMARY =========== -->
        
        <!-- =========== FIELD SUMMARY =========== -->
        

        <!-- =========== PROPERTY SUMMARY =========== -->
        
         <ul class="blockList">
                <li class="blockList"><a name="property_summary"><!--   --></a>
                    <h3>Properties Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties Summary table, listing nested classes, and an explanation">
                        <caption><span>Properties</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Type</th>
                            <th class="colLast" scope="col">Name and description</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code><strong><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a></strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#hash_iterations">hash_iterations</a></code><br>Customize the number of SHA-256 hash iterations performed during AES
      encryption operations.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code><strong><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Long.html' title='Long'>Long</a></strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#rotate_time_limit">rotate_time_limit</a></code><br>The time limit in seconds before AES secret and IV need to be rotated.
      </td>
                        </tr>
                        
                    </table>
                   </ul>
                </li>
            </ul>
        

        <!-- =========== ELEMENT SUMMARY =========== -->
        

        
        <!-- ======== CONSTRUCTOR SUMMARY ======== -->
        <ul class="blockList">
                <li class="blockList"><a name="constructor_summary"><!--   --></a>
                    <h3>Constructor Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructors Summary table">
                        <caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Constructor and description</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst">
                                <code><a href="#CipherMap(java.lang.String)">CipherMap</a>
                                (<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> privateKey)</code><br>Instantiates a new CipherMap object with the given private key.  </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst">
                                <code><a href="#CipherMap(java.lang.String, java.lang.Integer)">CipherMap</a>
                                (<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> privateKey, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations)</code><br>Instantiates a new CipherMap object with the given private key.  </td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst">
                                <code><a href="#CipherMap(java.io.File)">CipherMap</a>
                                (<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/File.html' title='File'>File</a> privateKey)</code><br>Instantiates a new CipherMap object with the given private key.  </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst">
                                <code><a href="#CipherMap(java.io.File, java.lang.Integer)">CipherMap</a>
                                (<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/File.html' title='File'>File</a> privateKey, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations)</code><br>Instantiates a new CipherMap object with the given private key.  </td>
                        </tr>
                        
                    </table>
                   </ul>
              </li>
        </ul>
        

        
        <!-- ========== METHOD SUMMARY =========== -->
        <ul class="blockList">
            
            <li class="blockList"><a name="method_summary"><!--   --></a>
                    <h3>Methods Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Methods Summary table">
                        <caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Type Params</th>
                            <th class="colLast" scope="col">Return Type</th>
                            <th class="colLast" scope="col">Name and description</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html' title='Map'>Map</a></code></td>
                            <td class="colLast"><code><strong><a href="#getPlainMap()">getPlainMap</a></strong>()</code><br>Decrypts the encrypted map and returns the object.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>void</code></td>
                            <td class="colLast"><code><strong><a href="#leftShift(def)">leftShift</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html' title='def'>def</a> input)</code><br>Load or append to this object enciphered text.  </td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>void</code></td>
                            <td class="colLast"><code><strong><a href="#setPlainMap(java.util.Map)">setPlainMap</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html' title='Map'>Map</a> obj)</code><br>Encrypts the object and stores it for later retrieval as enciphered text.
      </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#toString()">toString</a></strong>()</code><br>Returns an encrypted object as text meant for storing at rest.</td>
                        </tr>
                        
                    </table>
                   </ul>
              </li>
            
            <li class="blockList"><a name="method_summary"><!--   --></a>
                    <h3>Inherited Methods Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Inherited Methods Summary table">
                        <caption><span>Inherited Methods</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Methods inherited from class</th>
                            <th class="colLast" scope="col">Name</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code>class <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html' title='Object'>Object</a></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait(long)' title='wait'>wait</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait(long, int)' title='wait'>wait</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait()' title='wait'>wait</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)' title='equals'>equals</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#toString()' title='toString'>toString</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#hashCode()' title='hashCode'>hashCode</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#getClass()' title='getClass'>getClass</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#notify()' title='notify'>notify</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#notifyAll()' title='notifyAll'>notifyAll</a></code></td>
                        </tr>
                    </table>
                   </ul>
              </li>
                
        </ul>
        
    </li>
    </ul>
</div>

<div class="details">
    <ul class="blockList">
        <li class="blockList">
           

            

            
            <!-- =========== PROPERTY DETAIL =========== -->
            <ul class="blockList">
                <li class="blockList"><a name="prop_detail">
                    <!--   -->
                </a>
                    <h3>Property Detail</h3>
                    
                        <a name="hash_iterations"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> <strong>hash_iterations</strong></h4>
                                <p>
      Customize the number of SHA-256 hash iterations performed during AES
      encryption operations.
      <DL><DT><B>See Also:</B></DT><DD><a href='../../../../net/gleske/jervis/tools/SecurityIO.html#DEFAULT_AES_ITERATIONS' title='SecurityIO.DEFAULT_AES_ITERATIONS'>SecurityIO.DEFAULT_AES_ITERATIONS</a></DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="rotate_time_limit"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Long.html' title='Long'>Long</a> <strong>rotate_time_limit</strong></h4>
                                <p>
      The time limit in seconds before AES secret and IV need to be rotated.
      Once it reaches this age then new secrets will be generated.  Default:
      <tt>2592000</tt> seconds (number of seconds in 30 days).
      <DL><DT><B>See Also:</B></DT><DD><a href='#setPlainMap(java.util.Map)'>setPlainMap(java.util.Map)</a></DD></DL></p>
                            </li>
                        </ul>
                    
                </li>
            </ul>
            

            

            
            <!-- =========== CONSTRUCTOR DETAIL =========== -->
            <ul class="blockList">
                <li class="blockList"><a name="constructor_detail">
                    <!--   -->
                </a>
                    <h3>Constructor Detail</h3>
                    
                        <a name="CipherMap(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><strong>CipherMap</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> privateKey)</h4>
                                <p>
      Instantiates a new CipherMap object with the given private key.  This is
      used for asymmetric encryption wrapping symmetric encryption.
      <DL><DT><B>Parameters:</B></DT><DD><code>privateKey</code> -  A PKCS1 or PKCS8 private key PEM.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="CipherMap(java.lang.String, java.lang.Integer)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><strong>CipherMap</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> privateKey, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations)</h4>
                                <p>
      Instantiates a new CipherMap object with the given private key.  This is
      used for asymmetric encryption wrapping symmetric encryption.
      <DL><DT><B>See Also:</B></DT><DD><a href='#hash_iterations'>hash_iterations</a></DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>privateKey</code> -  A PKCS1 or PKCS8 private key PEM.</DD><DD><code>hash_iterations</code> -  Customize the hash iterations on instantiation.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="CipherMap(java.io.File)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><strong>CipherMap</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/File.html' title='File'>File</a> privateKey)</h4>
                                <p>
      Instantiates a new CipherMap object with the given private key.  This is
      used for asymmetric encryption wrapping symmetric encryption.
      <DL><DT><B>Parameters:</B></DT><DD><code>privateKey</code> -  A PKCS1 or PKCS8 private key.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="CipherMap(java.io.File, java.lang.Integer)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><strong>CipherMap</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/File.html' title='File'>File</a> privateKey, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations)</h4>
                                <p>
      Instantiates a new CipherMap object with the given private key.  This is
      used for asymmetric encryption wrapping symmetric encryption.
      <DL><DT><B>See Also:</B></DT><DD><a href='#hash_iterations'>hash_iterations</a></DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>privateKey</code> -  A PKCS1 or PKCS8 private key.</DD><DD><code>hash_iterations</code> -  Customize the hash iterations on instantiation.</DD></DL></p>
                            </li>
                        </ul>
                    
                </li>
            </ul>
            


            
            <!-- =========== METHOD DETAIL =========== -->
            <ul class="blockList">
                <li class="blockList"><a name="method_detail">
                    <!--   -->
                </a>
                    <h3>Method Detail</h3>
                    
                        <a name="getPlainMap()"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html' title='Map'>Map</a> <strong>getPlainMap</strong>()</h4>
                                <p>
      Decrypts the encrypted map and returns the object.<DL><DT><B>returns:</B></DT><DD>A map consisting of standard java class objects.</DD></DL>
      </p>
                            </li>
                        </ul>
                    
                        <a name="leftShift(def)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>void <strong>leftShift</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html' title='def'>def</a> input)</h4>
                                <p>
      Load or append to this object enciphered text.  There are three behaviors
      depending on the object type passed.

      <ol>
      <li>
        An encrypted <tt>String</tt> created from another <tt>CipherMap</tt>
        will load the secret into this <tt>CipherMap</tt> replacing the current
        <tt>CipherMap</tt>.
      </li>
      <li>
        If another <tt>CipherMap</tt> object is shifted then both this and the other
        object are decrypted.  The two maps are appended together and the
        combined result is encrypted.
      </li>
      <li>
        Throws an exception for any other type.
      </li>
      </ol>
      <DL><DT><B>See Also:</B></DT><DD><a href='#toString()'>toString for an example of the encrypted CipherMap String.</a></DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>input</code> -  A <tt>String</tt> to load or a <tt>CipherMap</tt> to append.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="setPlainMap(java.util.Map)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>void <strong>setPlainMap</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html' title='Map'>Map</a> obj)</h4>
                                <p>
      Encrypts the object and stores it for later retrieval as enciphered text.
      Before encryption occurs, the age of the AES-256 secret and IV is checked
      and rotated if beyond a certain age.
      <DL><DT><B>See Also:</B></DT><DD><a href='#rotate_time_limit'>rotate_time_limit</a></DD><DD><a href='#toString()'>toString()</a></DD><DD><a href='../../../../net/gleske/jervis/tools/YamlOperator.html' title='YamlOperator'>YamlOperator</a></DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>obj</code> -  The plain java object to be encrypted.  The object is
                 serialized by YamlOperator and must only consist of standard
                 java classes.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="toString()"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>toString</strong>()</h4>
                                <p>
      Returns an encrypted object as text meant for storing at rest.

<pre><code>
age: AES encrypted timestamp
cipher:
  - asymmetrically encrypted AES secret
  - asymmetrically encrypted AES IV
data: AES encrypted data
signature: RS256 Base64URL signature.
</code></pre>
      <DL><DT><B>See Also:</B></DT><DD><a href='#getPlainMap()'>getPlainMap()</a></DD><DD><a href='#leftShift(def)'>leftShift is used to load the ciphertext.</a></DD></DL><DL><DT><B>Returns:</B></DT><DD>Returns encrypted ciphertext.</DD></DL></p>
                            </li>
                        </ul>
                    
                </li>
            </ul>
            
        </li>
    </ul>
</div>

<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
    <!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
    <!--   -->
</a>
    <ul class="navList" title="Navigation">
        <li><a href="../../../../overview-summary.html">Overview</a></li>
        <li><a href="package-summary.html">Package</a></li>
        <li class="navBarCell1Rev">Class</li>
        <li><a href="../../../../deprecated-list.html">Deprecated</a></li>
        <li><a href="../../../../index-all.html">Index</a></li>
        <li><a href="../../../../help-doc.html">Help</a></li>
    </ul>
</div>

<div class="subNav">
    <div>
        <ul class="navList">
            <li><a href="../../../../index.html?net/gleske/jervis/tools/CipherMap" target="_top">Frames</a></li>
            <li><a href="CipherMap.html" target="_top">No Frames</a></li>
        </ul>
    </div>
    <div>
        <ul class="subNavList">
            <li>Summary:&nbsp;</li>
            Nested&nbsp;&nbsp;&nbsp;Field&nbsp;&nbsp;&nbsp;<li><a href="#property_summary">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_summary">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_summary">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
        <ul class="subNavList">
            <li>&nbsp;|&nbsp;Detail:&nbsp;</li>
            Field&nbsp;&nbsp;&nbsp;<li><a href="#prop_detail">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_detail">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_detail">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
    </div>
    <p><a href="https://github.com/samrocketman/jervis" target="_blank">Jervis</a> API documentation.</p>
    <a name="skip-navbar_bottom">
        <!--   -->
    </a>
    </div>
</div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
