<!--

     Licensed to the Apache Software Foundation (ASF) under one
     or more contributor license agreements.  See the NOTICE file
     distributed with this work for additional information
     regarding copyright ownership.  The ASF licenses this file
     to you under the Apache License, Version 2.0 (the
     "License"); you may not use this file except in compliance
     with the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

     Unless required by applicable law or agreed to in writing,
     software distributed under the License is distributed on an
     "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
     specific language governing permissions and limitations
     under the License.

-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- **************************************************************** -->
<!-- *  PLEASE KEEP COMPLICATED EXPRESSIONS OUT OF THESE TEMPLATES, * -->
<!-- *  i.e. only iterate & print data where possible. Thanks, Jez. * -->
<!-- **************************************************************** -->

<html>
<head>
    <!-- Generated by groovydoc -->
    <title>SecurityIO (Jervis 2.0 API)</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link href="../../../../groovy.ico" type="image/x-icon" rel="shortcut icon">
    <link href="../../../../groovy.ico" type="image/x-icon" rel="icon">
    <link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
    <link rel="stylesheet" href="../../../../styles/base16/harmonic16-dark.min.css">
    <script src="../../../../highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

<body class="center">
<script type="text/javascript"><!--
if (location.href.indexOf('is-external=true') == -1) {
    parent.document.title="SecurityIO (Jervis 2.0 API)";
}
//-->
</script>
<noscript>
    <div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
    <!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
    <!--   -->
</a>
    <ul class="navList" title="Navigation">
        <li><a href="../../../../overview-summary.html">Overview</a></li>
        <li><a href="package-summary.html">Package</a></li>
        <li class="navBarCell1Rev">Class</li>
        <li><a href="../../../../deprecated-list.html">Deprecated</a></li>
        <li><a href="../../../../index-all.html">Index</a></li>
        <li><a href="../../../../help-doc.html">Help</a></li>
    </ul>
</div>

<div class="subNav">
    <div>
        <ul class="navList">
            <li><a href="../../../../index.html?net/gleske/jervis/tools/SecurityIO" target="_top">Frames</a></li>
            <li><a href="SecurityIO.html" target="_top">No Frames</a></li>
        </ul>
    </div>
    <div>
        <ul class="subNavList">
            <li>Summary:&nbsp;</li>
            Nested&nbsp;&nbsp;&nbsp;Field&nbsp;&nbsp;&nbsp;<li><a href="#property_summary">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_summary">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_summary">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
        <ul class="subNavList">
            <li>&nbsp;|&nbsp;Detail:&nbsp;</li>
            Field&nbsp;&nbsp;&nbsp;<li><a href="#prop_detail">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_detail">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_detail">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
    </div>
    <a name="skip-navbar_top">
        <!--   -->
    </a></div>
<!-- ========= END OF TOP NAVBAR ========= -->

<!-- ======== START OF CLASS DATA ======== -->
<div class="header">

    <div class="subTitle">Package: <strong>net.gleske.jervis.tools</strong></div>

    <h2 title="[Groovy] Class SecurityIO" class="title">[Groovy] Class SecurityIO</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><ul class="inheritance"></ul></li><li>net.gleske.jervis.tools.SecurityIO
</ul>
<div class="description">
    <ul class="blockList">
        <li class="blockList">

            <dl>
                <dt>All Implemented Interfaces and Traits:</dt>
                <dd><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/Serializable.html' title='Serializable'>Serializable</a></dd>
            </dl>
            <!-- todo: direct known subclasses -->
            <hr>
            <br>
<pre>class SecurityIO
extends <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html' title='Object'>Object</a>

</pre>



    <p>
  A class to provide cryptographic features to Jervis such as RSA encryption and base64 encoding.

  <h2>Sample usage</h2>
  <p>To run this example, clone Jervis and execute <tt>./gradlew console</tt>
  to bring up a <a href="http://groovy-lang.org/groovyconsole.html" target="_blank">Groovy Console</a>
  with the classpath set up.</p>

<pre><code>
import net.gleske.jervis.tools.SecurityIO

if(!(new File('/tmp/id_rsa').exists())) {
    'openssl genrsa -out /tmp/id_rsa 4096'.execute().waitFor()
    'openssl rsa -in /tmp/id_rsa -pubout -outform pem -out /tmp/id_rsa.pub'.execute().waitFor()
}
def security = new SecurityIO(new File("/tmp/id_rsa").text)
println "Key size: ${security.rsa_keysize}"
def s = security.rsaEncrypt('hello friend')
println 'Length of encrypted output: ' + s.length()
println 'Encrypted string:'
println s
println 'Decrypted string:'
println security.rsaDecrypt(s)
new File('/tmp/id_rsa').delete()
new File('/tmp/id_rsa.pub').delete()
</code></pre>
 </p>

          </li>
    </ul>
</div>

<div class="summary">
    <ul class="blockList">
        <li class="blockList">
        <!-- =========== NESTED CLASS SUMMARY =========== -->
        

        <!-- =========== ENUM CONSTANT SUMMARY =========== -->
        
        <!-- =========== FIELD SUMMARY =========== -->
        

        <!-- =========== PROPERTY SUMMARY =========== -->
        
         <ul class="blockList">
                <li class="blockList"><a name="property_summary"><!--   --></a>
                    <h3>Properties Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Properties Summary table, listing nested classes, and an explanation">
                        <caption><span>Properties</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Type</th>
                            <th class="colLast" scope="col">Name and description</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code><strong>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a></strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#DEFAULT_AES_ITERATIONS">DEFAULT_AES_ITERATIONS</a></code><br>The default number of iterations of SHA-256 hashing of the AES IV when AES
      encryption or decryption is performed.  </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code><strong><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/KeyPair.html' title='KeyPair'>KeyPair</a></strong></code>&nbsp;</td>
                            <td class="colLast"><code><a href="#key_pair">key_pair</a></code><br>A decoded RSA key pair used for encryption and decryption, and signing.</td>
                        </tr>
                        
                    </table>
                   </ul>
                </li>
            </ul>
        

        <!-- =========== ELEMENT SUMMARY =========== -->
        

        
        <!-- ======== CONSTRUCTOR SUMMARY ======== -->
        <ul class="blockList">
                <li class="blockList"><a name="constructor_summary"><!--   --></a>
                    <h3>Constructor Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructors Summary table">
                        <caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Constructor and description</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst">
                                <code><a href="#SecurityIO()">SecurityIO</a>
                                ()</code><br>Instantiates an unconfigured instance of this class.  </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst">
                                <code><a href="#SecurityIO(java.lang.String)">SecurityIO</a>
                                (<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> private_key_pem)</code><br>Instantiates the class and configures a private key for decryption.
      </td>
                        </tr>
                        
                    </table>
                   </ul>
              </li>
        </ul>
        

        
        <!-- ========== METHOD SUMMARY =========== -->
        <ul class="blockList">
            
            <li class="blockList"><a name="method_summary"><!--   --></a>
                    <h3>Methods Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Methods Summary table">
                        <caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Type Params</th>
                            <th class="colLast" scope="col">Return Type</th>
                            <th class="colLast" scope="col">Name and description</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html' title='def'>def</a></code></td>
                            <td class="colLast"><code><strong><a href="#avoidTimingAttack(java.lang.Integer, groovy.lang.Closure)">avoidTimingAttack</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> milliseconds, <a href='http://docs.groovy-lang.org/latest/html/gapi/groovy/lang/Closure.html' title='Closure'>Closure</a> body)</code><br>This is a constant-time function intended to wrap security-sensitive code.
      </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;byte[]</code></td>
                            <td class="colLast"><code><strong><a href="#decodeBase64Bytes(java.lang.String)">decodeBase64Bytes</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</code><br>Decode a base64 <tt>String</tt> into <tt><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html' title='Byte'>Byte</a>s</tt>.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#decodeBase64String(java.lang.String)">decodeBase64String</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</code><br>Decode a base64 <tt>String</tt>.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;byte[]</code></td>
                            <td class="colLast"><code><strong><a href="#decodeBase64UrlBytes(java.lang.String)">decodeBase64UrlBytes</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</code><br>Decode a URL safe base64 <tt>String</tt> into <tt><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html' title='Byte'>Byte</a>s</tt>.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#decodeBase64UrlString(java.lang.String)">decodeBase64UrlString</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</code><br>Decode a URL safe base64 <tt>String</tt> into a <tt>String</tt>.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#decryptWithAES256(byte[], byte[], byte[], java.lang.Integer)">decryptWithAES256</a></strong>(byte[] secret, byte[] iv, byte[] data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</code><br>Decrypt ciphertext using AES-256 CBC mode with PKCS5 padding.  </td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#decryptWithAES256(java.lang.String, java.lang.String, java.lang.Integer)">decryptWithAES256</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> passphrase, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</code><br>Decrypts ciphertext with AES-256 using a passphrase.  </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#decryptWithAES256Base64(java.lang.String, java.lang.String, java.lang.String, java.lang.Integer)">decryptWithAES256Base64</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> secret, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> iv, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</code><br>Takes Base64 encoded secret and IV and decrypts the provided Base64
      encoded <tt>String</tt> data.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#encodeBase64(java.lang.String)">encodeBase64</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</code><br>Encode a <tt>String</tt> into a base64 <tt>String</tt>.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#encodeBase64(byte[])">encodeBase64</a></strong>(byte[] content)</code><br>Encode raw <tt><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html' title='Byte'>Byte</a>s</tt> into a base64 <tt>String</tt>.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#encodeBase64Url(java.lang.String)">encodeBase64Url</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</code><br>Encode raw <tt><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html' title='Byte'>Byte</a>s</tt> into a URL safe base64 <tt>String</tt>.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#encodeBase64Url(byte[])">encodeBase64Url</a></strong>(byte[] content)</code><br>Encode raw <tt><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html' title='Byte'>Byte</a>s</tt> into a URL safe base64 <tt>String</tt>.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;byte[]</code></td>
                            <td class="colLast"><code><strong><a href="#encryptWithAES256(byte[], byte[], java.lang.String, java.lang.Integer)">encryptWithAES256</a></strong>(byte[] secret, byte[] iv, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</code><br>Encrypt plaintext using AES-256 CBC mode with PKCS5 padding.  </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#encryptWithAES256(java.lang.String, java.lang.String, java.lang.Integer)">encryptWithAES256</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> passphrase, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</code><br>Encrypts String data with AES-256 using a passphrase.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#encryptWithAES256Base64(java.lang.String, java.lang.String, java.lang.String, java.lang.Integer)">encryptWithAES256Base64</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> secret, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> iv, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</code><br>Takes Base64 encoded secret and IV and encrypts the provided
      <tt>String</tt> data.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#getGitHubJWT(java.lang.String, java.lang.Integer, java.lang.Integer)">getGitHubJWT</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> github_app_id, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> expiration = 10, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> drift = 30)</code><br>Get a <a href="https://jwt.io/">JSON Web Token</a> (JWT) meant for use with
      <a href="https://docs.github.com/en/developers/apps/building-github-apps/authenticating-with-github-apps#authenticating-as-a-github-app">GitHub App Authentication</a>.
      </td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a></code></td>
                            <td class="colLast"><code><strong><a href="#getRsa_keysize()">getRsa_keysize</a></strong>()</code><br>Returns the calculated RSA private key size in bits calculated from the
      <tt><a href='#key_pair'>key_pair</a></tt>.  </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html' title='Boolean'>Boolean</a></code></td>
                            <td class="colLast"><code><strong><a href="#isSecureField(def)">isSecureField</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html' title='def'>def</a> field)</code><br>Checks to see if a field in the Jervis YAML is a
      <a href="https://github.com/samrocketman/jervis/wiki/Secure-secrets-in-repositories" target="_blank">secure field</a>.
      </td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;byte[]</code></td>
                            <td class="colLast"><code><strong><a href="#padForAES256(byte[])">padForAES256</a></strong>(byte[] input)</code><br>Repeats the input bytes until enough bytes are provided for AES-256.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;byte[]</code></td>
                            <td class="colLast"><code><strong><a href="#randomBytes(int)">randomBytes</a></strong>(int size)</code><br>Returns a random of bytes.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#randomBytesBase64(int)">randomBytesBase64</a></strong>(int size)</code><br>Base64 encoded random bytes.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#rsaDecrypt(java.lang.String)">rsaDecrypt</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> ciphertext)</code><br>Uses RSA asymmetric encryption to decrypt a ciphertext <tt>String</tt> and outputs plain text.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>byte[]</code></td>
                            <td class="colLast"><code><strong><a href="#rsaDecryptBytes(byte[])">rsaDecryptBytes</a></strong>(byte[] cipherbytes)</code><br>Uses RSA asymmetric encryption to decrypt enciphered bytes and returns plain bytes.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#rsaEncrypt(java.lang.String)">rsaEncrypt</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> plaintext)</code><br>Uses RSA asymmetric encryption to encrypt a plain text <tt>String</tt> and outputs ciphertext.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>byte[]</code></td>
                            <td class="colLast"><code><strong><a href="#rsaEncryptBytes(byte[])">rsaEncryptBytes</a></strong>(byte[] plainbytes)</code><br>Uses RSA asymmetric encryption to encrypt a plain bytes and outputs enciphered bytes.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>void</code></td>
                            <td class="colLast"><code><strong><a href="#setKey_pair(java.lang.String)">setKey_pair</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> pem)</code><br>Sets <tt><a href='#key_pair'>key_pair</a></tt> by decoding the <tt>String</tt>.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#sha256Sum(java.lang.String)">sha256Sum</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> input)</code><br>Calculates SHA-256 sum from a String.</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#sha256Sum(byte[])">sha256Sum</a></strong>(byte[] input)</code><br>Calculates SHA-256 sum from a byte-array.</td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a></code></td>
                            <td class="colLast"><code><strong><a href="#signRS256Base64Url(java.lang.String)">signRS256Base64Url</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data)</code><br>Creates a URL safe base64 string of a signature using algorithm RS256.
      </td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html' title='Boolean'>Boolean</a></code></td>
                            <td class="colLast"><code><strong><a href="#verifyGitHubJWTPayload(java.lang.String, java.lang.Integer)">verifyGitHubJWTPayload</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> github_jwt, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> drift = 30)</code><br>Verify a GitHub JWT is not expired by checking the signature and
      ensuring current time falls within issued at and expiration.  </td>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html' title='Boolean'>Boolean</a></code></td>
                            <td class="colLast"><code><strong><a href="#verifyJsonWebToken(java.lang.String)">verifyJsonWebToken</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> github_jwt)</code><br>Use the loaded public key to verify the provided JSON web token (JWT).</td>
                        </tr>
                        
                        <tr class="rowColor">
                            <td class="colFirst"><code></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html' title='Boolean'>Boolean</a></code></td>
                            <td class="colLast"><code><strong><a href="#verifyRS256Base64Url(java.lang.String, java.lang.String)">verifyRS256Base64Url</a></strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> signature, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data)</code><br>Verify data signed by RS256 Base64 URL encoded signature.</td>
                        </tr>
                        
                    </table>
                   </ul>
              </li>
            
            <li class="blockList"><a name="method_summary"><!--   --></a>
                    <h3>Inherited Methods Summary</h3>
                    <ul class="blockList">
                    <table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Inherited Methods Summary table">
                        <caption><span>Inherited Methods</span><span class="tabEnd">&nbsp;</span></caption>
                        <tr>
                            <th class="colFirst" scope="col">Methods inherited from class</th>
                            <th class="colLast" scope="col">Name</th>
                        </tr>
                        
                        <tr class="altColor">
                            <td class="colFirst"><code>class <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html' title='Object'>Object</a></code></td>
                            <td class="colLast"><code><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait(long)' title='wait'>wait</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait(long, int)' title='wait'>wait</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait()' title='wait'>wait</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)' title='equals'>equals</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#toString()' title='toString'>toString</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#hashCode()' title='hashCode'>hashCode</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#getClass()' title='getClass'>getClass</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#notify()' title='notify'>notify</a>, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#notifyAll()' title='notifyAll'>notifyAll</a></code></td>
                        </tr>
                    </table>
                   </ul>
              </li>
                
        </ul>
        
    </li>
    </ul>
</div>

<div class="details">
    <ul class="blockList">
        <li class="blockList">
           

            

            
            <!-- =========== PROPERTY DETAIL =========== -->
            <ul class="blockList">
                <li class="blockList"><a name="prop_detail">
                    <!--   -->
                </a>
                    <h3>Property Detail</h3>
                    
                        <a name="DEFAULT_AES_ITERATIONS"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> <strong>DEFAULT_AES_ITERATIONS</strong></h4>
                                <p>
      The default number of iterations of SHA-256 hashing of the AES IV when AES
      encryption or decryption is performed.  Default: <tt>5000</tt> iterations.
      <DL><DT><B>See Also:</B></DT><DD><a href='#decryptWithAES256(byte[], byte[], byte[], java.lang.Integer)'>decryptWithAES256(byte[], byte[], byte[], java.lang.Integer)</a></DD><DD><a href='#encryptWithAES256(byte[], byte[], java.lang.String, java.lang.Integer)'>encryptWithAES256(byte[], byte[], java.lang.String, java.lang.Integer)</a></DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="key_pair"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/KeyPair.html' title='KeyPair'>KeyPair</a> <strong>key_pair</strong></h4>
                                <p>
      A decoded RSA key pair used for encryption and decryption, and signing.

     <DL><DT><B>See Also:</B></DT><DD><a href='#setKey_pair(java.lang.String)'>setKey_pair(java.lang.String)</a></DD><DD><a href='#getRsa_keysize()'>getRsa_keysize()</a></DD></DL></p>
                            </li>
                        </ul>
                    
                </li>
            </ul>
            

            

            
            <!-- =========== CONSTRUCTOR DETAIL =========== -->
            <ul class="blockList">
                <li class="blockList"><a name="constructor_detail">
                    <!--   -->
                </a>
                    <h3>Constructor Detail</h3>
                    
                        <a name="SecurityIO()"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><strong>SecurityIO</strong>()</h4>
                                <p>
      Instantiates an unconfigured instance of this class.  Call
      <tt><a href='#setKey_pair(java.lang.String)'>setKey_pair(java.lang.String)</a></tt> to properly use this
      class.
     </p>
                            </li>
                        </ul>
                    
                        <a name="SecurityIO(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><strong>SecurityIO</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> private_key_pem)</h4>
                                <p>
      Instantiates the class and configures a private key for decryption.
      Automatically calls <tt><a href='#setKey_pair(java.lang.String)'>setKey_pair(java.lang.String)</a></tt> as
      part of instantiating.
     <DL><DT><B>Parameters:</B></DT><DD><code>private_key_pem</code> -  The contents of an X.509 PEM encoded RSA private key.</DD></DL><DL><DT><B>See Also:</B></DT><DD><a href='#setKey_pair(java.lang.String)'>setKey_pair(java.lang.String)</a></DD></DL></p>
                            </li>
                        </ul>
                    
                </li>
            </ul>
            


            
            <!-- =========== METHOD DETAIL =========== -->
            <ul class="blockList">
                <li class="blockList"><a name="method_detail">
                    <!--   -->
                </a>
                    <h3>Method Detail</h3>
                    
                        <a name="avoidTimingAttack(java.lang.Integer, groovy.lang.Closure)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html' title='def'>def</a> <strong>avoidTimingAttack</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> milliseconds, <a href='http://docs.groovy-lang.org/latest/html/gapi/groovy/lang/Closure.html' title='Closure'>Closure</a> body)</h4>
                                <p>
      This is a constant-time function intended to wrap security-sensitive code.
      This forces code to always take a certain amount of time regardless of
      input in order to have a constant-time result to avoid timing based
      attacks.

      <p>If <tt>milliseconds</tt> is a negative number, e.g. <tt>-200</tt>, then
      the delay will be randomized between 0 and <tt>milliseconds</tt> but not
      more than <tt>milliseconds</tt>.</p>

      <h2>Security Notes</h2>

      <p><b>Please Note:</b> due to how time works on computers sometimes the
      time can be 1 or 2 ms over the time you specify.  If you have an absolute
      maximum, then you should account for this in the value you pass.  This
      function can't guarantee absolute maximum.</p>

      <p><b>Please Note:</b> this function provides fixed maximum delays.  If
      code being called goes over this fixed delay, then timing attacks are
      still possible on your code.  You should account for this with defensive
      programming such as validating inputs on security sensitive code before
      calling algorithms.</p>

      <p><b>Please note:</b> randomized delay can have a limit.  If an attacker
      has infinite time and unlimited samples, then statistically randomness
      goes away.  This function makes it harder to calculate timing attacks;
      other protections should be in place on your code endpoints such as
      request limits within a given time frame.</p>

      <p><b>Please note:</b> These notes are known as defense in depth.  Have
      multiple controls around securing your code in case one control fails.
      Knowing the weakness of different controls enables you to better secure
      it with additional layers of security.</p>

  <h2>Sample usage</h2>
  <p>To run this example, clone Jervis and execute <tt>./gradlew console</tt>
  to bring up a <a href="http://groovy-lang.org/groovyconsole.html" target="_blank">Groovy Console</a>
  with the classpath set up.</p>

<pre><code>
import static net.gleske.jervis.tools.SecurityIO.avoidTimingAttack
import java.time.Instant

Integer mysecret = 0
Long before = Instant.now().toEpochMilli()
// Force code to always take 200ms
avoidTimingAttack(200) {
    mysecret = 1+1
}
assert mysecret == 2
println("Time taken (milliseconds): ${Instant.now().toEpochMilli() - before}ms")

before = Instant.now().toEpochMilli()
// Force code to randomly delay up to 200ms
avoidTimingAttack(-200) {
    mysecret = mysecret + 2
}
assert mysecret == 4
println("Time taken (milliseconds): ${Instant.now().toEpochMilli() - before}ms")

before = Instant.now().toEpochMilli()
// Set an implicit value.  Minimum execution time is 100ms random between 100-200ms.
mysecret = avoidTimingAttack(100) {
    avoidTimingAttack(-200) {
        mysecret + mysecret
    }
}
assert mysecret == 8
println("Time taken (milliseconds): ${Instant.now().toEpochMilli() - before}ms")
</code></pre>
      <DL><DT><B>Parameters:</B></DT><DD><code>milliseconds</code> -  The number of milliseconds a section of code must
                          minimally take.  If <tt>milliseconds</tt> is negative,
                          then randomly delay up to the value.  In both cases,
                          the maximum delay is fixed at the absolute value of
                          <tt>milliseconds</tt>.</DD><DD><code>body</code> -  A closure of code to execute.  The code will execute as fast
                  as it can and this function will enforce a constant time.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Returns the result from the executed closure.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="decodeBase64Bytes(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;byte[] <strong>decodeBase64Bytes</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</h4>
                                <p>
      Decode a base64 <tt>String</tt> into <tt><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html' title='Byte'>Byte</a>s</tt>.
     <DL><DT><B>Parameters:</B></DT><DD><code>content</code> -  Base64 encoded <tt>String</tt>.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Decoded raw <tt>Bytes</tt>.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="decodeBase64String(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>decodeBase64String</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</h4>
                                <p>
      Decode a base64 <tt>String</tt>.
     <DL><DT><B>Parameters:</B></DT><DD><code>content</code> -  Base64 encoded <tt>String</tt>.</DD></DL><DL><DT><B>Returns:</B></DT><DD>A decoded <tt>String</tt>.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="decodeBase64UrlBytes(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;byte[] <strong>decodeBase64UrlBytes</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</h4>
                                <p>
      Decode a URL safe base64 <tt>String</tt> into <tt><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html' title='Byte'>Byte</a>s</tt>.
     <DL><DT><B>Parameters:</B></DT><DD><code>content</code> -  URL safe base64 encoded <tt>String</tt>.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Decoded raw <tt>Bytes</tt>.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="decodeBase64UrlString(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>decodeBase64UrlString</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</h4>
                                <p>
      Decode a URL safe base64 <tt>String</tt> into a <tt>String</tt>.
     <DL><DT><B>Parameters:</B></DT><DD><code>content</code> -  A URL safe base64 encoded <tt>String</tt>.</DD></DL><DL><DT><B>Returns:</B></DT><DD>A decoded <tt>String</tt>.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="decryptWithAES256(byte[], byte[], byte[], java.lang.Integer)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>decryptWithAES256</strong>(byte[] secret, byte[] iv, byte[] data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</h4>
                                <p>
      Decrypt ciphertext using AES-256 CBC mode with PKCS5 padding.  The IV is
      hashed with multiple iterations of SHA-256.
      <DL><DT><B>See Also:</B></DT><DD><a href='#DEFAULT_AES_ITERATIONS'>DEFAULT_AES_ITERATIONS</a></DD><DD><a href="https://docs.oracle.com/en/java/javase/11/security/java-cryptography-architecture-jca-reference-guide.html#GUID-94225C88-F2F1-44D1-A781-1DD9D5094566" target=_blank>Java Cryptography Architecture (JCA) Reference Guide for <tt>Cipher</tt> class</a></DD><DD><a href="https://docs.oracle.com/en/java/javase/11/docs/specs/security/standard-names.html" target=_blank>Java Security Standard Algorithm Names</a>.</DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>secret</code> -  Secret key for decrypting.  If byte-count is less than 32
                    (256-bits), then bytes are repeated until 256 bits are available.</DD><DD><code>iv</code> -  Initialization vector (IV) used to initialize the cipher.</DD><DD><code>data</code> -  Data to be encrypted with AES-256.</DD><DD><code>hash_iterations</code> -  The IV is hashed with SHA-256.  For each iteration
                             the <tt>iv</tt> is combined with the previous
                             iteration result of the hashing.  The resulting
                             bytes are fed into <tt>PBKDF2WithHmacSHA256</tt>
                             resulting in a new initialization vector.  If set
                             to <tt>0</tt>, then hashing is skipped and the
                             original <tt>iv</tt> is used for AES cipher
                             initialization.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="decryptWithAES256(java.lang.String, java.lang.String, java.lang.Integer)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>decryptWithAES256</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> passphrase, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</h4>
                                <p>
      Decrypts ciphertext with AES-256 using a passphrase.  See the encrypt
      method for more details on both algorithms and usage.
      <DL><DT><B>See Also:</B></DT><DD><a href='#DEFAULT_AES_ITERATIONS'>DEFAULT_AES_ITERATIONS</a></DD><DD><a href='#encryptWithAES256(java.lang.String, java.lang.String, java.lang.Integer)'>encryptWithAES256 using passphrase method</a></DD><DD><a href='#decryptWithAES256(byte[], byte[], byte[], java.lang.Integer)'>decryptWithAES256 AES deciphering details</a></DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>passphrase</code> -  A passphrase used to decrypt AES-256 ciphertext.  See
                        encrypt method for more details.</DD><DD><code>data</code> -  Base64 encoded ciphertext to be decrypted.</DD><DD><code>hash_iterations</code> -  The number of iterations the AES-256 initialization
                             vector (IV) is hashed with SHA-256.  The minimum
                             iterations allowed is 1 for password-based
                             encryption.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="decryptWithAES256Base64(java.lang.String, java.lang.String, java.lang.String, java.lang.Integer)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>decryptWithAES256Base64</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> secret, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> iv, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</h4>
                                <p>
      Takes Base64 encoded secret and IV and decrypts the provided Base64
      encoded <tt>String</tt> data.
      <DL><DT><B>See Also:</B></DT><DD><a href='#encryptWithAES256(byte[], byte[], java.lang.String, java.lang.Integer)'>encryptWithAES256(byte[], byte[], java.lang.String, java.lang.Integer)</a></DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>secret</code> -  Base64 encoded binary secret.</DD><DD><code>iv</code> -  Base64 encoded binary initialization vector (IV).</DD><DD><code>data</code> -  Base64 encoded encrypted bytes to decrypt.</DD></DL><DL><DT><B>Returns:</B></DT><DD>A <tt>String</tt> which is plaintext.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="encodeBase64(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>encodeBase64</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</h4>
                                <p>
      Encode a <tt>String</tt> into a base64 <tt>String</tt>.
     <DL><DT><B>Parameters:</B></DT><DD><code>content</code> -  A plain <tt>String</tt>.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Base64 encoded <tt>String</tt></DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="encodeBase64(byte[])"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>encodeBase64</strong>(byte[] content)</h4>
                                <p>
      Encode raw <tt><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html' title='Byte'>Byte</a>s</tt> into a base64 <tt>String</tt>.
     <DL><DT><B>Parameters:</B></DT><DD><code>content</code> -  Base64 encoded <tt>String</tt>.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Decoded raw <tt>Bytes</tt>.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="encodeBase64Url(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>encodeBase64Url</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> content)</h4>
                                <p>
      Encode raw <tt><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html' title='Byte'>Byte</a>s</tt> into a URL safe base64 <tt>String</tt>.
     <DL><DT><B>Parameters:</B></DT><DD><code>content</code> -  A plain <tt>String</tt>.</DD></DL><DL><DT><B>Returns:</B></DT><DD>A URL safe Base64 encoded <tt>String</tt>.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="encodeBase64Url(byte[])"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>encodeBase64Url</strong>(byte[] content)</h4>
                                <p>
      Encode raw <tt><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Byte.html' title='Byte'>Byte</a>s</tt> into a URL safe base64 <tt>String</tt>.
     <DL><DT><B>Parameters:</B></DT><DD><code>content</code> -  Raw <tt>Bytes</tt>.</DD></DL><DL><DT><B>Returns:</B></DT><DD>A URL safe Base64 encoded <tt>String</tt>.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="encryptWithAES256(byte[], byte[], java.lang.String, java.lang.Integer)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;byte[] <strong>encryptWithAES256</strong>(byte[] secret, byte[] iv, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</h4>
                                <p>
      Encrypt plaintext using AES-256 CBC mode with PKCS5 padding.  The IV is
      hashed with multiple iterations of SHA-256.
      <DL><DT><B>See Also:</B></DT><DD><a href='#DEFAULT_AES_ITERATIONS'>DEFAULT_AES_ITERATIONS</a></DD><DD><a href="https://docs.oracle.com/en/java/javase/11/security/java-cryptography-architecture-jca-reference-guide.html#GUID-94225C88-F2F1-44D1-A781-1DD9D5094566" target=_blank>Java Cryptography Architecture (JCA) Reference Guide for <tt>Cipher</tt> class</a></DD><DD><a href="https://docs.oracle.com/en/java/javase/11/docs/specs/security/standard-names.html" target=_blank>Java Security Standard Algorithm Names</a>.</DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>secret</code> -  Secret key for decrypting.  If byte-count is less than 32
                    (256-bits), then bytes are repeated until 256 bits are available.</DD><DD><code>iv</code> -  Initialization vector (IV) used to initialize the cipher.</DD><DD><code>data</code> -  Data to be encrypted with AES-256.</DD><DD><code>hash_iterations</code> -  The IV is hashed with SHA-256.  For each iteration
                             the <tt>iv</tt> is combined with the previous
                             iteration result of the hashing.  The resulting
                             bytes are fed into <tt>PBKDF2WithHmacSHA256</tt>
                             resulting in a new initialization vector.  If set
                             to <tt>0</tt>, then hashing is skipped and the
                             original <tt>iv</tt> is used for AES cipher
                             initialization.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="encryptWithAES256(java.lang.String, java.lang.String, java.lang.Integer)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>encryptWithAES256</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> passphrase, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</h4>
                                <p>
      Encrypts String data with AES-256 using a passphrase.

      <h2>Sample usage</h2>
<pre><code>
import net.gleske.jervis.tools.SecurityIO
import java.time.Instant

Long time(Closure c) {
    Long before = Instant.now().epochSecond
    c()
    Long after = Instant.now().epochSecond
    after - before
}

String encrypted
Long timing1 = time {
    encrypted = SecurityIO.encryptWithAES256('correct horse battery staple', 'My secret data')
}


println("Encrypted text: ${encrypted}")
Long timing2 = time {
    println("Decrypted text: ${SecurityIO.decryptWithAES256('correct horse battery staple', encrypted)}")
}

println "Encrypt time: ${timing1} second(s)\nDecrypt time: ${timing2} second(s)"
</code></pre>
      <DL><DT><B>See Also:</B></DT><DD><a href='#DEFAULT_AES_ITERATIONS'>DEFAULT_AES_ITERATIONS</a></DD><DD><a href='#encryptWithAES256(byte[], byte[], java.lang.String, java.lang.Integer)'>encryptWithAES256 AES enciphering details</a></DD><DD><a href="https://docs.oracle.com/en/java/javase/11/security/java-cryptography-architecture-jca-reference-guide.html#GUID-5E8F4099-779F-4484-9A95-F1CEA167601A" target=_blank>Java Cryptography Architecture (JCA) Reference Guide for <tt>SecretKeyFactory</tt> class</a></DD><DD><a href="https://docs.oracle.com/en/java/javase/11/docs/specs/security/standard-names.html#secretkeyfactory-algorithms" target=_blank><tt>SecretKeyFactory</tt> algorithm names</a></DD><DD><a href="https://www.nist.gov/publications/recommendation-password-based-key-derivation-part-1-storage-applications" target=_blank>Recommendation for Password-Based Key Derivation Part 1: Storage Applications</a>;
           Published: December 22, 2010; Citation: Special Publication (NIST SP) - 800-132</DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>passphrase</code> -  A passphrase used to generate AES keys for encryption.
                        The passphrase creates an AES key using
                        <tt>PBKDF2WithHmacSHA256</tt>, a salt created from
                        passphrase checksum, and variable PBKDF2 iterations
                        based on passphrase checksum.  The PBKDF2 iterations
                        are between <tt>100100</tt> and <tt>960000</tt>.</DD><DD><code>data</code> -  Data to be encrypted.</DD><DD><code>hash_iterations</code> -  The number of iterations the AES-256 initialization
                             vector (IV) is hashed with SHA-256.  The minimum
                             iterations allowed is 1 for password-based
                             encryption.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="encryptWithAES256Base64(java.lang.String, java.lang.String, java.lang.String, java.lang.Integer)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>encryptWithAES256Base64</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> secret, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> iv, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> hash_iterations = DEFAULT_AES_ITERATIONS)</h4>
                                <p>
      Takes Base64 encoded secret and IV and encrypts the provided
      <tt>String</tt> data.
      <DL><DT><B>See Also:</B></DT><DD><a href='#encryptWithAES256(byte[], byte[], java.lang.String, java.lang.Integer)'>encryptWithAES256(byte[], byte[], java.lang.String, java.lang.Integer)</a></DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>secret</code> -  Base64 encoded binary secret.</DD><DD><code>iv</code> -  Base64 encoded binary initialization vector (IV).</DD><DD><code>data</code> -  A plain <tt>String</tt> to be encrypted (not Base64 encoded).</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="getGitHubJWT(java.lang.String, java.lang.Integer, java.lang.Integer)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>getGitHubJWT</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> github_app_id, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> expiration = 10, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> drift = 30)</h4>
                                <p>
      Get a <a href="https://jwt.io/">JSON Web Token</a> (JWT) meant for use with
      <a href="https://docs.github.com/en/developers/apps/building-github-apps/authenticating-with-github-apps#authenticating-as-a-github-app">GitHub App Authentication</a>.
      This assumes the <tt>SecurityIO</tt> class was loaded with an RSA private
      key provided by GitHub App Authentication setup.

      <h2>Sample usage</h2>

      The following code will generate a JWT, verify it, and extract its
      payload contents.

<pre><code>
import net.gleske.jervis.tools.SecurityIO

if(!(new File('/tmp/id_rsa').exists())) {
    'openssl genrsa -out /tmp/id_rsa 4096'.execute().waitFor()
    'openssl rsa -in /tmp/id_rsa -pubout -outform pem -out /tmp/id_rsa.pub'.execute().waitFor()
}
def security = new SecurityIO(new File("/tmp/id_rsa").text)
// use a fake App ID of 1234
String jwt = security.getGitHubJWT('1234')
if(security.verifyGitHubJWTPayload(jwt)) {
    println('JWT is currently valid.')
} else {
    println('JWT is invalid or expired.')
}

// Issue a 1 minute duration JWT, using clock drift 2 minutes in the past so that it is expired
jwt = security.getGitHubJWT('1234', 1, 120)
if(security.verifyGitHubJWTPayload(jwt)) {
    println('JWT is currently valid.')
} else {
    println('JWT is invalid or expired.')
}
</code></pre>
      <DL><DT><B>Parameters:</B></DT><DD><code>github_app_id</code> -  The GitHub App ID available when generating a GitHub App.</DD><DD><code>expiration</code> -     The duration of the JWT in minutes before the JWT
                           expires.  The maximum value supported by GitHub is
                           10 minutes.  Minimum expiration is <tt>1</tt>
                           minute.  Default: <tt>10</tt> minutes.</DD><DD><code>drift</code> -          Number of seconds in the past used as the starting
                           point of the JWT.  This is to account for clock
                           drift between two remote systems as a conservative
                           measure.  If the drift is set for 30 seconds that
                           means the issues JWT will expire in 9 minutes, 30
                           seconds in the future (10 minutes total if you
                           include 30 seconds for clock drift).
                           Default: <tt>30</tt> seconds.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Returns a signed JWT.  This does not guarantee a
                           valid token just that a token is issued and signed.
                           Use <tt><a href='#verifyGitHubJWTPayload(java.lang.String, java.lang.Integer)'>verifyGitHubJWTPayload(java.lang.String, java.lang.Integer)</a></tt>
                           method to verify the token is valid given the
                           current time.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="getRsa_keysize()"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> <strong>getRsa_keysize</strong>()</h4>
                                <p>
      Returns the calculated RSA private key size in bits calculated from the
      <tt><a href='#key_pair'>key_pair</a></tt>.  e.g. a 4096-bit RSA key will return <tt>4096</tt>.

      <h2>Sample usage</h2>
<pre><code>
import net.gleske.jervis.tools.SecurityIO
def security = new SecurityIO(new File("/tmp/id_rsa").text)
println "Key size: ${security.rsa_keysize}"
</code></pre><DL><DT><B>returns:</B></DT><DD>Key size of the private key if <tt><a href='#key_pair'>key_pair</a></tt> is
               set.  If no private key, then returns <tt>0</tt>.</DD></DL>
     </p>
                            </li>
                        </ul>
                    
                        <a name="isSecureField(def)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html' title='Boolean'>Boolean</a> <strong>isSecureField</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html' title='def'>def</a> field)</h4>
                                <p>
      Checks to see if a field in the Jervis YAML is a
      <a href="https://github.com/samrocketman/jervis/wiki/Secure-secrets-in-repositories" target="_blank">secure field</a>.
      If it is then decryption should be attempted.  This only detects of decryption
      is plausible.
     <DL><DT><B>Parameters:</B></DT><DD><code>property</code> -  A simple object that can take multiple types to check against.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Returns <tt>true</tt> if the field can potentially be decrypted.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="padForAES256(byte[])"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;byte[] <strong>padForAES256</strong>(byte[] input)</h4>
                                <p>
      Repeats the input bytes until enough bytes are provided for AES-256.
      <DL><DT><B>Parameters:</B></DT><DD><code>input</code> -  Bytes to be repeated.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="randomBytes(int)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;byte[] <strong>randomBytes</strong>(int size)</h4>
                                <p>
      Returns a random of bytes.
      <DL><DT><B>Parameters:</B></DT><DD><code>size</code> -  Number of random bytes to generate.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Random bytes provided by <tt>NativePRNGNonBlocking</tt>.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="randomBytesBase64(int)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>randomBytesBase64</strong>(int size)</h4>
                                <p>
      Base64 encoded random bytes.
      <DL><DT><B>See Also:</B></DT><DD><a href="https://docs.oracle.com/en/java/javase/11/docs/specs/security/standard-names.html" target=_blank>Java Security Standard Algorithm Names</a>.</DD></DL><DL><DT><B>Parameters:</B></DT><DD><code>size</code> -  Number of random bytes to generate.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Random bytes wrapped with Base64 encoding.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="rsaDecrypt(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>rsaDecrypt</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> ciphertext)</h4>
                                <p>
      Uses RSA asymmetric encryption to decrypt a ciphertext <tt>String</tt> and outputs plain text.

      For third party reference, this is essentially executing the following commands in a terminal.

<pre><code>
echo 'ciphertext' | openssl enc -base64 -A -d | openssl rsautl -decrypt -inkey /tmp/id_rsa
</code></pre>
     <DL><DT><B>Parameters:</B></DT><DD><code>ciphertext</code> -  A Base64 encoded ciphertext <tt>String</tt> to be decrypted.</DD></DL><DL><DT><B>Returns:</B></DT><DD>A plain text <tt>String</tt> or more generically: <tt>plaintext = RSAPrivateKeyDecrypt(base64decode(ciphertext))</tt></DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="rsaDecryptBytes(byte[])"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>byte[] <strong>rsaDecryptBytes</strong>(byte[] cipherbytes)</h4>
                                <p>
      Uses RSA asymmetric encryption to decrypt enciphered bytes and returns plain bytes.
      <DL><DT><B>Parameters:</B></DT><DD><code>cipherbytes</code> -  Encrypted bytes.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Returns decrypted bytes.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="rsaEncrypt(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>rsaEncrypt</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> plaintext)</h4>
                                <p>
      Uses RSA asymmetric encryption to encrypt a plain text <tt>String</tt> and outputs ciphertext.

      For third party reference, this is essentially executing the following commands in a terminal.

<pre><code>
echo -n 'plaintext' | openssl rsautl -encrypt -inkey ./id_rsa.pub -pubin | openssl enc -base64 -A
</code></pre>
     <DL><DT><B>Parameters:</B></DT><DD><code>plaintext</code> -  A plain text <tt>String</tt> to be encrypted.</DD></DL><DL><DT><B>Returns:</B></DT><DD>A Base64 encoded ciphertext or more generically: <tt>ciphertext = base64encode(RSAPublicKeyEncrypt(plaintext))</tt></DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="rsaEncryptBytes(byte[])"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>byte[] <strong>rsaEncryptBytes</strong>(byte[] plainbytes)</h4>
                                <p>
      Uses RSA asymmetric encryption to encrypt a plain bytes and outputs enciphered bytes.
      <DL><DT><B>Parameters:</B></DT><DD><code>plainbytes</code> -  Plain bytes to be encrypted.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Enciphered bytes are returned.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="setKey_pair(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>void <strong>setKey_pair</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> pem)</h4>
                                <p>
      Sets <tt><a href='#key_pair'>key_pair</a></tt> by decoding the <tt>String</tt>.
     <DL><DT><B>Parameters:</B></DT><DD><code>pem</code> -  An X.509 PEM encoded RSA private key.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="sha256Sum(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>sha256Sum</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> input)</h4>
                                <p>
      Calculates SHA-256 sum from a String.
      <DL><DT><B>Parameters:</B></DT><DD><code>input</code> -  A <tt>String</tt> to calculate a SHA-256 digest.</DD></DL><DL><DT><B>Returns:</B></DT><DD>A SHA-256 hex <tt>String</tt>.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="sha256Sum(byte[])"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4>static&nbsp;<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>sha256Sum</strong>(byte[] input)</h4>
                                <p>
      Calculates SHA-256 sum from a byte-array.
      <DL><DT><B>Parameters:</B></DT><DD><code>input</code> -  A <tt>String</tt> to calculate a SHA-256 digest.</DD></DL><DL><DT><B>Returns:</B></DT><DD>A SHA-256 hex <tt>String</tt>.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="signRS256Base64Url(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> <strong>signRS256Base64Url</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data)</h4>
                                <p>
      Creates a URL safe base64 string of a signature using algorithm RS256.
      This data signature is meant for use in <a href="https://jwt.io/">JSON
      Web Tokens</a>.
      <DL><DT><B>Parameters:</B></DT><DD><code>data</code> -  Any data meant to be signed with RS256 algorithm.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Returns a URL safe base64 encoded <tt>String</tt> of the
                  signature.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="verifyGitHubJWTPayload(java.lang.String, java.lang.Integer)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html' title='Boolean'>Boolean</a> <strong>verifyGitHubJWTPayload</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> github_jwt, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Integer.html' title='Integer'>Integer</a> drift = 30)</h4>
                                <p>
      Verify a GitHub JWT is not expired by checking the signature and
      ensuring current time falls within issued at and expiration.  This does
      both signature checking and decoding the payload to check for validity.
      See also
      <a href="https://docs.github.com/en/developers/apps/building-github-apps/authenticating-with-github-apps#authenticating-as-a-github-app">GitHub App Authentication</a>.
      <DL><DT><B>Parameters:</B></DT><DD><code>github_jwt</code> -  A JWT meant for use in GitHub App Auth.</DD><DD><code>drift</code> -       Add seconds into the future in order to account for
                        clock drift.  If <tt>30</tt> seconds are added that
                        means this will assume a token expires 30 seconds
                        before it really expires.  If you issue a token with a
                        30 second drift and verify the token with a 30 second
                        drift then the maximum duration for a token is
                        <tt>9</tt> minutes.
                        Default: <tt>30</tt> seconds.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="verifyJsonWebToken(java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html' title='Boolean'>Boolean</a> <strong>verifyJsonWebToken</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> github_jwt)</h4>
                                <p>
      Use the loaded public key to verify the provided JSON web token (JWT).
      <DL><DT><B>Parameters:</B></DT><DD><code>jwt</code> -  A JSON Web Token meant for authentication.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Returns <tt>true</tt> if the signature was successfully
                 verified or <tt>false</tt> if signature verification failed.</DD></DL></p>
                            </li>
                        </ul>
                    
                        <a name="verifyRS256Base64Url(java.lang.String, java.lang.String)"><!-- --></a>
                        <ul class="blockListLast">
                            <li class="blockList">
                                <h4><a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Boolean.html' title='Boolean'>Boolean</a> <strong>verifyRS256Base64Url</strong>(<a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> signature, <a href='https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html' title='String'>String</a> data)</h4>
                                <p>
      Verify data signed by RS256 Base64 URL encoded signature.
      <DL><DT><B>Parameters:</B></DT><DD><code>signature</code> -  A Base64 URL encoded signature of RS256 algorithm.</DD><DD><code>data</code> -       The data in which the signature should verify.</DD></DL><DL><DT><B>Returns:</B></DT><DD>Returns <tt>true</tt> if the signature was successfully
                       verified or <tt>false</tt> if signature verification
                       failed.</DD></DL></p>
                            </li>
                        </ul>
                    
                </li>
            </ul>
            
        </li>
    </ul>
</div>

<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
    <!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
    <!--   -->
</a>
    <ul class="navList" title="Navigation">
        <li><a href="../../../../overview-summary.html">Overview</a></li>
        <li><a href="package-summary.html">Package</a></li>
        <li class="navBarCell1Rev">Class</li>
        <li><a href="../../../../deprecated-list.html">Deprecated</a></li>
        <li><a href="../../../../index-all.html">Index</a></li>
        <li><a href="../../../../help-doc.html">Help</a></li>
    </ul>
</div>

<div class="subNav">
    <div>
        <ul class="navList">
            <li><a href="../../../../index.html?net/gleske/jervis/tools/SecurityIO" target="_top">Frames</a></li>
            <li><a href="SecurityIO.html" target="_top">No Frames</a></li>
        </ul>
    </div>
    <div>
        <ul class="subNavList">
            <li>Summary:&nbsp;</li>
            Nested&nbsp;&nbsp;&nbsp;Field&nbsp;&nbsp;&nbsp;<li><a href="#property_summary">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_summary">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_summary">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
        <ul class="subNavList">
            <li>&nbsp;|&nbsp;Detail:&nbsp;</li>
            Field&nbsp;&nbsp;&nbsp;<li><a href="#prop_detail">Property</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#constructor_detail">Constructor</a></li>&nbsp;&nbsp;&nbsp;<li><a href="#method_detail">Method</a></li>&nbsp;&nbsp;&nbsp;
        </ul>
    </div>
    <p><a href="https://github.com/samrocketman/jervis" target="_blank">Jervis</a> API documentation.</p>
    <a name="skip-navbar_bottom">
        <!--   -->
    </a>
    </div>
</div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
